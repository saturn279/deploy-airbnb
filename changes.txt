-added hdfs storage type
-refactor metrics